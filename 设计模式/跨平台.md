# 平台检测

通过`typeof`检测特殊的全局变量以及属性确定代码运行的平台。根据不同的平台在运行时选择不同的分支运行。这会导致引入了所有平台的代码，却只运行了特定的平台的分支,而且容易造成敏感信息无意泄漏。

在构建时做代码分支，只打包特定平台分支的代码。在webpack中可以通过`DefinePlugin`定义特定全局变量,再通过`terser-webpack-plugin`插件优化剔除没有运行到的分支代码。

无论是在构建时还是运行时做代码分支，都需要在去做分支判断，这中判断不宜过多，应该将跟平台相关的代码统一放入一个模块中，在构建时进行模块替换。(webpack中可以使用`NormalModuleReplacement`内置插件)